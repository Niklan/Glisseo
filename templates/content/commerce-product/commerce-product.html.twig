{% set bem_block = 'commerce-product-' ~ commerce_product.bundle|clean_class %}
{%
  set bem_modifiers = bem_modifiers|merge([
    view_mode != 'default' ? 'vm-' ~ view_mode|clean_class|replace({'--': '-'}),
  ])
%}
{%
  set classes = [
    bem_block,
  ]
%}
{% for bem_modifier in bem_modifiers %}
  {% if bem_modifier|length %}
    {% set classes = classes|merge([bem_block ~ '--' ~ bem_modifier]) %}
  {% endif %}
{% endfor %}
<article{{ attributes.addClass(classes) }}>
  {% block commerce_product %}
    {{ title_prefix }}
    {{ title_suffix }}

    {% block content %}
      {{- product|without('variation_attributes') -}}
    {% endblock content %}
  {% endblock commerce_product %}
</article>
